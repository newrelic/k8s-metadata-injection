suite: labels
templates:
  - templates/deployment.yaml
release:
  name: my-release
  namespace: my-namespace
tests:
  - it: should inherit global.labels when local labels not set
    set:
      cluster: test-cluster
      global.labels:
        globalLabel1: globalValue1
        globalLabel2: globalValue2
    asserts:
      - equal:
          path: metadata.labels.globalLabel1
          value: globalValue1
      - equal:
          path: metadata.labels.globalLabel2
          value: globalValue2

  - it: should merge local labels with global.labels (local takes precedence)
    set:
      cluster: test-cluster
      labels:
        localLabel: localValue
        sharedLabel: localValue
      global.labels:
        globalLabel: globalValue
        sharedLabel: globalValue
    asserts:
      - equal:
          path: metadata.labels.localLabel
          value: localValue
      - equal:
          path: metadata.labels.globalLabel
          value: globalValue
      - equal:
          path: metadata.labels.sharedLabel
          value: localValue

  - it: should inherit global.podLabels when local podLabels not set
    set:
      cluster: test-cluster
      global.podLabels:
        globalPodLabel1: globalPodValue1
        globalPodLabel2: globalPodValue2
    asserts:
      - equal:
          path: spec.template.metadata.labels.globalPodLabel1
          value: globalPodValue1
      - equal:
          path: spec.template.metadata.labels.globalPodLabel2
          value: globalPodValue2

  - it: should merge local podLabels with global.podLabels (local takes precedence)
    set:
      cluster: test-cluster
      podLabels:
        localPodLabel: localPodValue
        sharedPodLabel: localPodValue
      global.podLabels:
        globalPodLabel: globalPodValue
        sharedPodLabel: globalPodValue
    asserts:
      - equal:
          path: spec.template.metadata.labels.localPodLabel
          value: localPodValue
      - equal:
          path: spec.template.metadata.labels.globalPodLabel
          value: globalPodValue
      - equal:
          path: spec.template.metadata.labels.sharedPodLabel
          value: localPodValue
